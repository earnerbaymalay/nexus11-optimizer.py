function Invoke-AppxDebloat { param($Config, $ConfigFile); Write-Host ''; Write-Host '  :: PACKAGE REMOVAL' -ForegroundColor $Config.Theme.Title; Draw-Line '-' -Config $Config; try { $Bloatware = Get-Content -Raw -Path $ConfigFile | ConvertFrom-Json } catch { Log-Action 'Failed to read bloatware.json' 'FAIL' -Config $Config; return }; foreach ($App in $Bloatware) { if (Get-AppxPackage -Name $App -ErrorAction SilentlyContinue) { Get-AppxPackage -Name $App -AllUsers | Remove-AppxPackage -AllUsers -ErrorAction SilentlyContinue; Log-Action "Removed $App" 'OK' -Config $Config } } Log-Action 'Bloatware Scan Complete' 'DONE' -Config $Config }
Export-ModuleMember -Function Invoke-AppxDebloat
