function Invoke-GamingOptimizations { param($Config); Write-Host ''; Write-Host '  :: PERFORMANCE OVERDRIVE' -ForegroundColor $Config.Theme.Title; Draw-Line '-' -Config $Config; if (-not (powercfg -list | Select-String 'Ultimate Performance')) { powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 | Out-Null; powercfg -setactive e9a42b02-d5df-448d-aa00-03f14749eb61 | Out-Null; Log-Action 'Ultimate Plan Injected' 'OK' -Config $Config } else { Log-Action 'Ultimate Plan Active' 'SKIP' -Config $Config } Log-Action 'Disabling GameDVR' 'OK' -Config $Config; Set-ItemProperty -Path 'HKCU:\System\GameConfigStore' -Name 'GameDVR_Enabled' -Value 0 -Force; Log-Action 'Unthrottling Network' 'OK' -Config $Config; if (!(Test-Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile')) { New-Item -Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile' -Force | Out-Null }; Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile' -Name 'NetworkThrottlingIndex' -Value 4294967295 -Force }
Export-ModuleMember -Function Invoke-GamingOptimizations
