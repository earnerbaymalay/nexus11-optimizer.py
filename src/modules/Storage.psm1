function Invoke-StorageOptimizations { param($Config); Write-Host ''; Write-Host '  :: STORAGE ANALYSIS' -ForegroundColor $Config.Theme.Title; Draw-Line '-' -Config $Config; $drive = Get-PSDrive C; $used = [math]::Round($drive.Used / 1GB, 2); $free = [math]::Round($drive.Free / 1GB, 2); Write-Host "  [i] DRIVE C: USED: $used GB  |  FREE: $free GB" -ForegroundColor $Config.Theme.Text; Write-Host ''; Log-Action 'Emptying Recycle Bin' 'OK' -Config $Config; Clear-RecycleBin -DriveLetter C -Force -ErrorAction SilentlyContinue; Log-Action 'Purging Update Cache' 'WAIT' -Config $Config; Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue; Remove-Item -Path 'C:\Windows\SoftwareDistribution\Download\*' -Recurse -Force -ErrorAction SilentlyContinue; Start-Service -Name wuauserv -ErrorAction SilentlyContinue; Log-Action 'Cache Cleared' 'OK' -Config $Config; Log-Action 'Executing TRIM' 'WAIT' -Config $Config; Optimize-Volume -DriveLetter C -Normal -ErrorAction SilentlyContinue; Log-Action 'Optimization Finished' 'OK' -Config $Config }
Export-ModuleMember -Function Invoke-StorageOptimizations
